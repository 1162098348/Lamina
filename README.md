# Lamina
## **1. 概述**
**Lamina** 是一种面向过程的数学计算语言，专注于数学问题的高效解决，支持图灵完备性。其设计目标是提供简洁、直观的语法，同时支持复杂数学运算（如向量、矩阵、递归、循环等）。

---

## **2. 基础语法**
### **2.1 关键字**
以下为保留字，不可用作变量名或函数名：
```plaintext
var          // 变量声明
func         // 函数定义
if           // 条件判断
else         // 条件分支
while        // 循环
for          // 计数循环
return       // 返回值
break        // 中断循环
continue     // 跳过当前迭代
print        // 输出
exit         // 退出程序
true         // 布尔值
false        // 布尔值
null         // 空值
include      // 导入
```

### **2.2 注释**
- **单行注释**：`# 注释内容`

---

## **3. 数据类型**
### **3.1 基本类型**
| **类型**       | **描述**                                  | **示例**               |
|----------------|------------------------------------------|-----------------------|
| `int`          | 整数                                    | `42`, `-10`           |
| `float`        | 浮点数                                  | `3.14`, `-0.5`        |
| `complex`      | 复数（格式：`a + bi`）                   | `3 + 4i`, `2i`        |
| `bool`         | 布尔值                                  | `true`, `false`       |
| `str`          | 字符串（单引号或双引号）                  | `"Hello"`, `'world'`             |
| `null`         | 空值                                    | `null`                |

### **3.2 复合类型**
#### **数组（Array）**
- **语法**：`[元素1, 元素2, ...]`
- **示例**：
  ```Lamina
  var arr = [1, 2, 3];          // 数组初始化
  var nested = [[1,2], [3,4]];  // 多维数组
  ```

#### **向量（Vector）**
- **语法**：`[元素1, 元素2, ...]`（隐式向量类型）
- **特性**：
  - 支持向量运算（加减、点积、叉积等）。
  - 维度一致性检查（如加法需维度相同）。

#### **矩阵（Matrix）**
- **语法**：`[[行1元素], [行2元素], ...]`
- **示例**：
  ```Lamina
  var m = [[1,2], [3,4]];  // 2x2矩阵
  ```

#### **函数（Func）**
- **一等公民**：可赋值给变量、作为参数传递。
- **示例**：
  ```Lamina
  var add = func(a, b) { return a + b; };
  ```

---

## **4. 运算符**
### **4.1 算术运算符**
| **运算符** | **功能**               | **示例**               |
|------------|------------------------|-----------------------|
| `+`        | 加法                   | `2 + 3 → 5`           |
| `-`        | 减法                   | `5 - 2 → 3`           |
| `*`        | 乘法                   | `4 * 3 → 12`          |
| `/`        | 除法（浮点结果）       | `5 / 2 → 2.5`         |
| `//`       | 整数除法               | `5 // 2 → 2`          |
| `%`        | 取模                   | `7 % 3 → 1`           |
| `^`        | 幂运算                 | `2^3 → 8`             |
| `!`        | 阶乘（仅整数）         | `5! → 120`            |

### **4.2 向量/矩阵运算符**
| **运算符/函数** | **功能**               | **示例**               |
|------------|------------------------|-----------------------|
| `+`        | 向量加法               | `[1,2] + [3,4] → [4,6]`  |
| `*`        | 标量乘法/矩阵乘法      | `2 * [1,2] → [2,4]`    |
| `dot(a,b)` | 向量点积               | `dot([1,2], [3,4]) → 11`  |
| `cross(a,b)` | 向量叉积（三维向量）   | `cross([1,0,0], [0,1,0]) → [0,0,1]` |
| `det(m)`   | 计算矩阵行列式         | `det([[1,2],[3,4]]) → -2` |
| `norm(v)`  | 向量模长               | `norm([3,4]) → 5`      |
| `normalize(v)` | 向量归一化         | `normalize([1,1]) → [0.707,0.707]` |

### **4.3 比较运算符**
| **运算符** | **功能**               | **示例**               |
|------------|------------------------|-----------------------|
| `==`       | 等于                   | `5 == 5 → true`       |
| `!=`       | 不等于                 | `3 != 4 → true`       |
| `>`        | 大于                   | `5 > 3 → true`        |
| `<`        | 小于                   | `2 < 1 → false`       |
| `>=`       | 大于等于               | `4 >= 4 → true`       |
| `<=`       | 小于等于               | `3 <= 2 → false`      |

---

## **5. 控制结构**
### **5.1 条件语句**
```Lamina
if (条件) {
    // 条件为真时执行
} else if (另一个条件) {
    // 条件为真时执行
} else {
    // 其他情况执行
}
```

### **5.2 循环**
#### **`while` 循环**
```Lamina
var i = 0;
while (i < 5) {
    print(i);
    i += 1;
}
```

#### **`for` 循环**
```Lamina
for (var i = 0; i < 5; i++) {
    print(i);
}
```

### **5.3 流程控制**
- `break`：退出当前循环。
- `continue`：跳过当前循环迭代。

---

## **6. 函数**
### **6.1 函数定义**
```Lamina
func 函数名(参数1, 参数2, ...) {
    // 函数体
    return 返回值;  // 可选
}
```

### **6.2 递归函数**
```Lamina
func factorial(n) {
    if (n == 0) {
        return 1;
    }
    return n * factorial(n - 1);
}
```

### **6.3 匿名函数**
```Lamina
var add = func(a, b) { return a + b; };
print(add(2, 3));  // 输出 5
```

---

## **7. 内建函数库**
### **7.1 数学函数**
| **函数**       | **描述**                          | **示例**               |
|----------------|----------------------------------|-----------------------|
| `sqrt(x)`      | 平方根                          | `sqrt(9) → 3`         |
| `abs(x)`       | 绝对值                          | `abs(-5) → 5`         |
| `sin(x)`       | 正弦函数（弧度）                | `sin(0) → 0`          |
| `cos(x)`       | 余弦函数                        | `cos(0) → 1`          |
| `tan(x)`       | 正切函数                        | `tan(0) → 0`          |
| `log(x)`       | 自然对数                        | `log(2.718) → 1`      |
| `round(x)`     | 四舍五入到整数                  | `round(2.6) → 3`      |
| `floor(x)`     | 向下取整                        | `floor(2.9) → 2`      |
| `ceil(x)`      | 向上取整                        | `ceil(2.1) → 3`       |

### **7.2 向量/矩阵函数**
| **函数**       | **描述**                          | **示例**               |
|----------------|----------------------------------|-----------------------|
| `dot(v1, v2)`  | 向量点积                        | `dot([1,2], [3,4]) → 11` |
| `cross(v1, v2)`| 三维向量叉积                    | `cross([1,0,0], [0,1,0]) → [0,0,1]` |
| `norm(v)`      | 向量模长                        | `norm([3,4]) → 5`      |
| `normalize(v)` | 向量归一化                      | `normalize([1,1]) → [0.707,0.707]` |
| `det(m)`       | 矩阵行列式（2x2, 3x3）          | `det([[1,2],[3,4]]) → -2` |

### **7.3 工具函数**
| **函数**       | **描述**                          | **示例**               |
|----------------|----------------------------------|-----------------------|
| `array(...)`   | 创建数组                        | `array(1,2,3) → [1,2,3]` |
| `size(x)`      | 获取大小                        | `size([1,2,3]) → 3`    |
| `print(...)`   | 打印多个值                      | `print("x =", 42)`     |
| `input(prompt)`| 获取用户输入                    | `input("Name: ") → "Alice"` |

---

## **8. 输入与输出**
### **8.1 输出**
```Lamina
print("Hello, Lamina!");     // 输出文本
print("x =", 42);           // 输出多个值
print(5 + 3);               // 输出计算结果
```

### **8.2 输入**
```Lamina
var name = input("Enter your name: ");     // 带提示的输入
var number = input();                      // 无提示输入
print("Hello,", name, "! Number:", number);
```

**注意：** `input()` 函数会自动尝试将输入解析为数字，如果失败则返回字符串。

---

## **9. 模块系统**
### **9.1 包含模块**
```Lamina
include "math_utils";        // 包含外部模块（自动添加.lm扩展名）
include "vector_utils.lm";   // 显式指定扩展名
```

### **9.2 模块定义**
在模块文件 `math_utils.lm` 中：
```Lamina
# math_utils.lm
var PI = 3.14159265359;

func degrees_to_radians(degrees) {
    return degrees * PI / 180;
}

func circle_area(radius) {
    return PI * radius * radius;
}
```

### **9.3 使用模块**
```Lamina
include "math_utils";
print("PI =", PI);                           // 使用模块中的变量
print("90° =", degrees_to_radians(90), "rad"); // 使用模块中的函数
```
export func sqrt(x) { ... };
export var pi = 3.14159;
```

---

## **10. 图灵完备性验证**
### **10.1 递归**
```Lamina
func fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n-1) + fibonacci(n-2);
}
```

### **10.2 无限循环**
```Lamina
while (true) {
    print("Running...");
    // 需用户干预退出
}
```

---

## **11. 错误处理**
### **11.1 错误类型**
- **语法错误**：如未闭合的括号。
- **运行时错误**：如除以零、维度不匹配的向量运算。

### **11.2 错误示例**
```Lamina
var v1 = [1,2];  // 二维向量
var v2 = [3,4,5]; // 三维向量
var invalid = v1 × v2;  // 报错：叉积仅支持三维向量
```

---

## **12. 示例代码**
### **12.1 解二次方程**
```Lamina
func quadratic(a, b, c) {
    var discriminant = b^2 - 4*a*c;
    if (discriminant < 0) {
        print("Complex roots");
        var real = -b/(2*a);
        var imag = sqrt(-discriminant)/(2*a);
        return [real + " + " + imag + "i", real + " - " + imag + "i"];
    } else {
        var root1 = (-b + sqrt(discriminant))/(2*a);
        var root2 = (-b - sqrt(discriminant))/(2*a);
        return [root1, root2];
    }
}

var roots = quadratic(1, -3, 2);
print("Roots: " + roots);  // 输出 [1, 2]
```

---

## **13. 设计原则**
1. **简洁性**：语法简洁，符合数学表达习惯。
2. **数学友好**：直接支持向量、矩阵和常用数学运算。
3. **面向过程**：通过函数组织代码，避免复杂对象模型。
4. **图灵完备**：支持无限循环、递归和任意计算。

---

## **14. 未来扩展**
- **并行计算**：支持多线程加速复杂运算。
- **高级数学库**：如统计函数、微积分运算。

---

## **15. 参考**
- **关键字**：严格遵循保留字列表。
- **运算符优先级**：`! > ^ > * / % > + - > == != > && ||`。

---

